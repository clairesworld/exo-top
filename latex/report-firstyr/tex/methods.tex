\section{Model description}

\begin{table}
\centering
\caption{Parameters used in this study. \label{tab:params}}
\footnotesize
\begin{tabular}{@{} c l r l p{4cm} @{}}
%\multicolumn{5}{l}{\textbf{Constant values for all planets}} \\
\toprule
Symbol & Description & Value & Units & Ref. \\
\midrule
\multicolumn{5}{c}{\textbf{Constant bulk properties}} \\
$\rho_c$ & Core density & 7200 & kg m$^{-3}$ &  \citet{Thiriet2019}  \\
$c_c$ & Core specific heat (p or v?) & 840 & J kg$^{-1}$ K$^{-1}$  & \citet{Thiriet2019}  \\
$k_m$ & Mantle thermal conductivity & 4 & W m$^{-1}$ K$^{-1}$  & \citet{Thiriet2019}  \\
$\alpha_m$ & Thermal expansivity &  $2.5 \times 10^{-5}$ & K$^{-1}$  & \citet{Thiriet2019}  \\
$X_{\rm K}$ & Initial K abundance &  305 & wt ppm  & \citet{Jaupart2015} \\
$X_{\rm U}$ & Initial U abundance &  $16 \times 10^{-3}$ & wt ppm  & \citet{Jaupart2015} \\
$X_{\rm Th}$ & Initial Th abundance &  $56 \times 10^{-3}$ & wt ppm  & \citet{Jaupart2015} \\
$H_{4.5}$ & Radiogenic heating rate at 4.5 Gyr & $4.6\times 10^{-12}$ & W kg$^{-1}$ & \citet{Jaupart2015} \\
Ra$_{\rm crit, u}$ & Critical Rayleigh number & 450 &  & \citet{Thiriet2019}  \\
$E_a$ & Viscosity activation energy & 300 & kJ mol$^{-1}$ & \citet{Karato1993} \\
$A_{rh}$ & Viscosity preexponential factor & 8.7e15 & & \citet{Karato1993} \\
$h_{rh}$ & Grain size & 2.07 & mm & \\
$B$ & Burgers vector & 0.5 & nm & \citet{Karato1993} \\
$m$ & Grain size exponent & 2.5 & & \citet{Karato1993} \\
$\mu$ & Shear modulus & 80 & GPa & \citet{Karato1993} \\
CMF & Core mass fraction & 0.3 & & \\
$L_*$ & Stellar luminosity & 1 & $L_{\rm Sun}$ &  \\
Al & Planetary geometric albedo & 0 & &  \\

\midrule
\multicolumn{5}{c}{\textbf{Solar system models}} \\
$M_p$ & Planet mass &  \makecell[tr]{\textbf{Mars:} 0.11 \\ \textbf{Venus:} 0.82} & \makecell[tl]{$M_\oplus$ \\ $M_\oplus$ } &  \\
$R_c$ & Core radius &  \makecell[tr]{\textbf{Mars:} 1700 \\ \textbf{Venus:} 3330} & \makecell[tl]{km \\ km } &  \makecell[tl]{\citet{Thiriet2019} \\ \citet{Huang2013}} \\
$\rho_m$ & Mantle density & \makecell[tr]{\textbf{Mars:} 3500 \\ \textbf{Venus:} 3300} & \makecell[tl]{kg m$^{-3}$ \\ kg m$^{-3}$} &   \makecell[tl]{\citet{Thiriet2019} \\ \citet{Nimmo1996}} \\
$c_m$ & Mantle specific heat (p or v?) & \makecell[tr]{\textbf{Mars:} 1142 \\ \textbf{Venus:} 1200} & \makecell[tl]{J kg$^{-1}$ K$^{-1}$ \\ J kg$^{-1}$ K$^{-1}$}  & \makecell[tl]{\citet{Thiriet2019} \\  \citet{Nimmo1996}}  \\
$T_s$ & Surface temperature & \makecell[tr]{\textbf{Mars:} 250 \\ \textbf{Venus:} 730} & \makecell[tl]{K \\ K} \\

\midrule
\multicolumn{5}{c}{\textbf{Initial conditions}} \\
$T_{m,0}$ & Initial mantle temperature & 1750 & K & \citet{Thiriet2019}\\
$T_{c,0}$ & Initial core temperature & 2250 & K & \citet{Thiriet2019} \\
$D_{l,0}$ & Initial lid thickness & 300 & km & \citet{Thiriet2019}\\
\bottomrule
\end{tabular}



%
%\begin{tabular}{@{} c l r l  @{}}
%\multicolumn{4}{l}{\textbf{Exoplanet parameter study}} \\
%\toprule
%Symbol & Description & Range & Units \\
%\midrule
%$M_p$ & Planet mass & Range & kg \\
%CMF & Core mass fraction & Range &  \\
%$E_a$ & Viscosity activation energy & Range & kJ mol$^{-1}$ \\
%$h$ & Grain size & Range & mm \\
%\bottomrule
%\end{tabular}

\end{table}







We start with a simple model of thermal history based on parameterized convection. From this we can estimate dynamic topography directly using scaling relationships in the literature.

Table \ref{tab:params} lists the parameters used in this work. The key free parameters we are interested in tuning are the planet mass, $M_p$, core mass fraction, CMF, viscosity activation energy $E_a$ and prefactor, and initial mantle and core temperatures $T_m$ and $T_c$. The initial temperature contains information about the formation history of the planet, namely the leftover gravitational energy of accretion and core segregation. Although $\alpha$, $\rho_m$, and $\kappa_m$ vary with depth \citep{Anderson1987}, geophysical observables are most sensitive to the upper mantle value \citep{Kiefer1992}, which is what we use here.

From the input parameters in Table \ref{tab:params} we get the derived bulk properties: the radius of the planet, $R_p$, based on \citet{Zeng2016},
\begin{equation}
\frac{R_p}{R_E} = (1.07 - 0.21\; {\rm CMF})\left(\frac{M_p}{M_E}\right)^{1/3.7},
\end{equation}
which has surface area SA$_p$; the radius of the core, using the scaling relationship from \citet{Zeng2017},
\begin{equation}
R_c = R_p \; {\rm CMF}^{0.5},
\end{equation}
which has surface area SA$_c$; the surface gravity, $g_{\rm sfc} = 6.674\times 10^{-11}M_p/R_p^2$; and the thermal diffusivity of the mantle, $\kappa_m = k_m/(\rho_m c_m)$. For our Mars and Venus models, we use the observed $R_p$ and $M_p$ which are known fairly precisely, along with $R_c$ assumptions from the literature. 


We can also find the surface temperature, $T_s$, assuming the surface is in blackbody equilibrium,
\begin{align}
T_s &= \left(\frac{q_* \pi R_p^2}{\sigma_{\rm SB} \; {\rm SA}_p}\right)^{1/4},\\
q_* &= \frac{L_*(1-{\rm Al})}{4 \pi a^2};
\end{align}
where $q_*$ is the incident stellar radiation in W m$^{-2}$, Al is the geometric albedo, $L_*$ is the stellar luminosity, and $\sigma_{\rm SB}$ is the Stefanâ€“Boltzmann constant, but for solar system planets we take the measured $T_s$ (see Table \ref{tab:params}). $T_s$ turns out to have no effect on $\Delta h$.




\subsection{Temperature-dependent viscosity, stagnant lid convection}\label{sec:viscosity-model}

Essentially we want to solve equation (\ref{eq:T_ODE}), which we do using the explicit Runge-Kutta method of order 5(4).
We use a temperature-dependent Arrhenius rheology law \citep{Karato1993} as a first step with parameters in Table (\ref{tab:params}), as this helps us understand the physical basis of tweaking rheology. We choose $h_{rh}$ to match the linearized rheology of \citet{Thiriet2019}.

\subsubsection{Heat fluxes}
Heat fluxes are calculated using the common scalings from parameterized convection models. Throughout, heat fluxes per unit volume or area are given by lowercase $q$, and the planet-integrated value in uppercase $Q$. The radiogenic heat flux in W kg$^{-1}$ is:
\begin{align}
q_{\rm rad} &= H_0\sum^{\rm K, U, Th}_n \left[ h_{n}  e^{\lambda_n (t_f - t)} \right], \nonumber \\
h_n &= \frac{c_n p_n}{\sum c_n p_n}, \\
c_n &= \frac{n_nX_n}{n_{\rm U} X_{\rm U}} \nonumber ,
\end{align}
where we are summing over the heat-producing elements K, U, and Th, $H_{0}$ is the present-day heat production in W kg$^{-1}$, $h_n$ is the relative contribution of the $n^{th}$ isotope, $c_n$ is radiogenic element abundance relative to U, $n_n$ is the natural isotopic abundance in terms of mass, $X_n$ is the bulk planet abundance in terms of mass, $p_n$ is the heating power in W kg$^{-1}$, $t_f$ is the present-day age, and $\lambda_n$ is the decay constant in s$^{-1}$ \citep{Korenaga2006}. We use the canonical values for decay constants and isotopic natural abundances \citep{Jaupart2015}.

Heat travels by conduction through the upper and lower thermal boundary layers, so these fluxes depend on thermal conductivity, $k_m$, and the boundary layer thickness, $\delta$, with subscripts $u$ and $c$ referring to the upper and lower layers respectively: 
\begin{align}
q_{u, c} &= k_m \frac{\Delta T_{u, c}}{\delta_{u, c}} \label{eq:q_u}\\
\delta_{u, c} &= d \left(\frac{{\rm Ra}_{{\rm crit}, u, c}}{{\rm Ra}_{rh, u, c}}\right)^\beta,\label{eq:d_u}
\end{align}
where we equate Ra$_{rh}$ with the interior Rayleigh number from equation \ref{eq:Ra}. We assume $\beta = 1/3$, so convecting layer depth $h$ cancels out.\footnote{Numerical studies give $\beta$ around 0.3 \citep{Thiriet2019}.} For $\Delta T_u$ we use $T_c - T_l$, and $\Delta T_c = T_c - T_m$. $T_l$ is the temperature at the top of the convecting region. Viscosity is taken at the isothermal middle for the upper boundary layer, and at $T_c + T_m/2$ for the lower, after \citet{Thiriet2019}. Gravity is evaluated at the surface for $\delta_u$ and at the core radius for $\delta_c$. The critical Rayleigh numbers are Ra$_{{\rm crit}, u}$ = Ra$_{{\rm crit}}$, and Ra$_{{\rm crit}, c}$ = 0.28Ra$_{i}^{0.21}$, where Ra$_{i}$ is the interior Rayleigh number as in equation (\ref{eq:Ra}) \citep{Thiriet2019}.




\subsubsection{Temperatures and heat flow in the lid}

We distinguish between the upper thermal boundary layer of the convecting region and the stagnant lid. Specifically, the temperature at the top of the mantle thermal boundary layer, $T_l$, would not be set at the planetary surface temperature. Conceptually, the ``lid" in a stagnant lid refers to a mechanical transition, and is dynamically decoupled from the convecting region. We are not distinguishing petrological (compositional) layers at this point, and so we avoid referring to our lid as a ``lithosphere," although they share some roles.

Fluid dynamics experiments show that the temperature jump between the isothermal core of the convecting region at $T_m$ and the top of the thermal boundary layer at $T_l$ is proportional to the viscous temperature scale $\Delta T_{rh}$: the rate of viscosity change with temperature \citep{Davaille1993},
\begin{align}
\label{eq:Tl}
T_{l} &= T_m - a_{rh} \Delta T_{rh} \\
\Delta T_{rh} &= \frac{\eta(T_m)}{{\rm d}\eta/{\rm d}T_m\vert_{Tm}} = \frac{R_b T_m^2}{E_a},
\end{align}
where $R_b$ is the universal gas constant, and $a_{rh} = 2.44$ for $\beta = 1/3$ based on fits to 3D convection models \citep{Thiriet2019}. (\ref{eq:Tl} has the same form regardless of Arrhenius or linear rheology law. 



In the stagnant lid of thickness $D_l$ above this layer, the temperature decreases from $T_l$ to $T_s$ by conductive heat transport, which in spherical coordinates is:
\begin{align}
T_{\rm lid}(r) &= \frac{-a_0}{6k_l} r^2 + \frac{c_1}{k_m r} + c_2 \\
    c_1 &= k_m \frac{T_l - T_s - a_0/(6 k_m) \left(R_p^2 - R_l^2\right)}{1/R_l - 1/R_p} \\
    c_2 &= T_s + \frac{a_0}{6 k_m} R_p^2 - \frac{c_1}{k_m R_p}
\end{align} 
where $k_l = k_m$ is thermal conductivity, $a_0 = \rho H_0$ is the lithospheric heat production in W m$^{-3}$, assumed to be constant with $r$. For now we are assuming radiogenic heating in the lid is equivalent to in the interior; we might anticipate more radiogenic heating in the lid because it overlaps with the lithophilic element-rich crust in a real planet.

Evaluating the associated conductive heat flux, $-k_l \d T/\d r$, at $r = R_p$ gives the surface heat flux:
\begin{align}
q_{\rm lid} &= -\frac{a_0}{3k_m}r - \frac{c_1}{k_m r^2},\\
q_{s} &= -\frac{a_0}{3k_m}R_p - \frac{c_1}{k_m R_p^2}.
\end{align}



\subsubsection{Lid thickness}

%As a zeroth order case, we can assume a constant lid thickness over the planet's evolution.
%
%At intermediate complexity, we assume flux is continuous where the upper thermal boundary layer meets the stagnant lid:
%\begin{align}
%\label{eq:t-continuity}
%&T_{\rm lid}(z=-d_l) = T_m + \Delta T_\eta \\
%&\frac{H_l}{2k}d_l^2 + \frac{q_{ubl}\left(T_m\right)}{k}d_l + \left(T_m - T_s - \frac{R_b}{E_a}T_m^2\right)  = 0
%\end{align}
%where $q_{ubl}$ is a function of only $T_m$ if $\beta=1/3$ ($\delta_{ubl}$ independent of mantle depth). The roots of this equation give $d_l$ as a function of $T_m(t)$ and $H_l(t)$, which allows $d_l$ to be calculated at each time-step. It can be shown that there is one positive root for our range of parameters.


We account for the fact that the lid does not instantly grow or shrink in response to a change in $q_{u}$. There is some lag where $D_l$ adjusts such that the flux out of the top of the lid is moving towards equilibrium with the flux into the base of the lid \citep{Thiriet2019}:
\begin{equation}\label{eq:D_l}
\frac{\d D_l}{\d t} = \frac{q_{\rm lid}\vert_{R_l} -q_u}{\rho_m c_{m} (T_m - T_l)} . 
\end{equation}
From this we can calculate $R_l = R_p - D_l$; we also account for the mass of the convecting region $M_m$ changing with $R_l$. This ignores the time-dependence of heat conduction in the lid (i.e., requiring a P.D.E.), which is associated with an error of a few mW m$^{-2}$ \citep{Thiriet2019}.




\subsection{Height of dynamic topography}

We consider three scaling laws to estimate the root-mean-square (RMS) amplitude of dynamic topography. The first is written using equation (\ref{eq:sigma_conv}). Boundary layer theory predicts that convective stress scales as \citep{Solomatov1995}:
\begin{align}
\tau_{zz} \propto \rho_m g \alpha_m \Delta T_{rh} \delta_u 
\end{align}
where $\alpha_m$ is the mantle thermal expansivity (the volume change due to a temperature change), and $\Delta T_{rh}$ and $\delta_u$ are the temperature difference across and thickness of the upper thermal boundary layer from (\ref{eq:Tl}) and (\ref{eq:d_u}). \citet{Reese2005} give proportionality constant $C_1 = 0.1$ for interior shear stress and $C = 2$ for lid shear stress.

\begin{itemize}
\item isn't it only the normal component of stress that you care about for dynamic topography?
\item does the stress scaling include thermal isostasy density contrasts - check solomatov 1995 - i think probably 
\end{itemize}

Thus dynamic topography scales with $T_m$ and $q_{u}$ as:
\begin{equation}\label{eq:dyn_top_stress}
\Delta h \sim C_1 \alpha_m \Delta T_{rh} \delta_u.
\end{equation}
We can also write this analytically in terms of Ra:
\begin{equation}
\Delta h \propto \left(\frac{\rm Ra}{\rm Ra_{\rm crit}}\right)^{-\frac{1}{3}}.
\end{equation}


The second is provided by the cartesian geometry, constant-viscosity case of \citet{Parsons1983} equation (33), with scaling exponent $\beta$ on surface-flux Ra taken to equal 0.5 (their no-internal-heating case):
\begin{equation}\label{eq:PD83}
\Delta h \sim C_2 \left[\frac{\alpha_m q_{s} \eta_m(T) \kappa_m}{\rho_m g k_m}\right]^\frac{1}{2},
\end{equation}
where $C_2 = 5.4$ to match the predictions of RMS dynamic topography in \citet{Lees2019}. This should be equivalent to equation (\ref{eq:dyn_top_stress}); the approximation expressed in the latter comes from the notion that most of the contribution to surface topography is in the displacement of stress boundaries in the thermal boundary layer.

The third scaling comes from fits to cylindrical geometry, constant-viscosity numerical experiments of \citet{Kiefer1992}:
\begin{equation}\label{eq:KH92}
0.7 \Delta h = 66 {\rm Ra}^{-0.121},
\end{equation}
where the factor of 0.7 = $(\rho_m - \rho_w) / \rho_m$ is scaling their water-loaded model to subaerial topography.

Although both (\ref{eq:PD83}) and (\ref{eq:KH92}) are scalings for ``peak topography" over a given rising plume, we naively treat them as the global RMS dynamic topography, $\Delta h_{\rm RMS}$, assuming that the values of $\tau_{zz}$ they are based on reflects the global RMS convective stress.

